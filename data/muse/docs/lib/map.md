--:! {map: [] (:)} } <- **Map Command Line Library** -> muse/docs/lib/map.md      
--:| map: _Orientation and position reporting, broadcast and persistence of places_ -> map  

--:# **File and Broadcast Operations for points, trails, and ranges (including features)**  

--:: map.place(placeString: ":") -> _Instantiate string as named place, include in named places._ -> `serial: ":", index: #: &!`  

--:: map.read(thisMap: ":") -> _Reinstantiate places from map file._ -> `serial: ":", index: #: &!`  

--:: map.write(thisMap: ":"?) -> _Delete old, write new locally. Default current._ -> `nil &!`  

--:- site name? -> _Remote operation to report or change site (persistently) after, e.g., porting `rover`._  

--:- join site role -> _Set site and join landed turtle to it with specified role._  

--:: map.update(serial: ":") -> _Append received instantiated MU to local map file_. -> `nil &!`  

--:# **Map File Operations**  

--:- sync -> _Muse Update (MU) broadcast local map to (MQ) registered units._  

--:- erase name -> _Remove named place, broadcast Muse eXcise (MX)._  

--:# **Referenced through `map.op` for CLI dispatch**  

--:: map.erase(name: ":") -> _Remove named place, overwrite local map file_ -> `remaining: #:`  

--:: map.get(name: ":", key: ":") -> _Get named place local feature value for key._ -> `value: any?` &!  

--:: map.gets(name: ":", key: ":") -> _Less generic retrieval interface: gets string feature value._ -> `":"?`  

--:: map.put(name: ":", key: ":", value: any?) -> _Set named place feature, send MU._ ->  `key: ":"?, value: any|true|nil &!`  

--:: map.puts(name: ":", key: ":", value: ":"?) -> _Set string feature value, send MU._ -> `key: ":", value: ":"|true &!`  

--:# **Report direction turtle is facing (requires GPS in game)**  

--:: map.testFacing(dx: #:, dz: #:) -> _Find orientation using position changes for non-zero movement._ -> `facing: ":" & !`  

--:- fix trail? -> _Set and report GPS turtle position for dead reckoning. Optionally begin named trailhead._  

--:< **Places - Points, Locations, Trails, and Ranges of Maps**  

--:- point name label trail? -> _Add named labeled point, can start trail, MU updated map. (Player situation needs GPS.)_     
--:+ _Optional `trail` starts turtle movement `track` ended by call to `trail` limited by `Muse.tracking.limit`._  

--:: map.set(name: ":", label: ":", x: #:, y: #:, z: #:, f: ":") -> _Set turtle at created point -> ":"  

--:: map.point(name: ":", label: ":", :xyzf:) -> _Create, send point update._ -> `nil & !`  

--:: map.locations(template: :[name: ":", offset: xyz], base: ":", label: ":", top: #:) -> _Add points offset from base._ -> `nil`    
--:+ _Add labelled points using template names and offsets from named base point or top for y-axis._  

--:- trail name label -> _Include named point at head and (current situation) tail of a new trail, update map._     
--:+ _Call to `trail` establishes a trail of tracked turtle movements from the head of the trail named and started by `point`._    
--:+ _It also establishes a trail from the tail of the trail named by `trail` back to the head of the trail._    
--:+ _Both trails (from the head to the tail of the `trail` and back) share a `label` as specified in the call to `trail`._    
--:+ _Turtles can move along trails with calls to <a href="roam.html#trace" target="_blank">`roam.trace`</a>._   

--:- range name label point point key? value?? -> _Volume by named points, optional key and value for feature._   

--:- chart filename ... -> _Loads and runs named file in `charts` directory to create named point and associated ranges._    
--:+ **While there are conventions (indicated), there's no restriction in what loading and running the file actually does!**    
--:+ _The function generated by loading the file is applied to the ... parameters following the chart file name._    
--:+ _This chart file function is expected to create ranges establishing the `chart` and a way to reference those ranges._    
--:+ _There is nothing to enforce this expectation. The chart file could do (oh, my) pretty much anything._   

--:: map.borders(range: place) -> _Get range elements_ -> `borders, features, position, position &!`  

--:> borders: _Range boundarires_ -> {east: #:, west: #:, north: #:, south: #:, top: #:, bottom: #:}  

--:< **Navigation in Maps: Where Are We, What's Nearby, and Where Are We Heading?**  

--:- at -> _Report current (dead reckoning) turtle position and facing or player GPS position._   

--:- test name, label, x, y, z, facing, key?, value??} -> _Force mapped position, optionally feature and value for `point`._  

--:- where place? count?? -> _Report movement direction, distance to named place (or all) three (or count) closest places._   

--:- headings rate? place? count?? -> _Repeated movement report at specified rate (or every _G.Muse.rates.headings) seconds)._  

--:- near place? span?? -> _Report points within span blocks (or all) of named place (or current player or turtle position)._  

--:- view place -> _Report place details including all situations and features._  

--:# **Command Line Interface**   

--:: map.op(commands: ":"[]}) -> _Command Line Interface_ -> `report: ":" &:`  